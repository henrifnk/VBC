[{"path":"https://henrifnk.github.io/VBC/articles/vbc_alps.html","id":"allgäuer-hochalpen","dir":"Articles","previous_headings":"","what":"Allgäuer Hochalpen","title":"VBC in the Alps: Multivariate Bias Correction and Evaluation","text":"Allgäuer Hochalpen mountainous nature reserve northern Alps border Austria. 2,600 meters sea level, nature reserve first northern mountain range Alps. Due regional exposition, Allgäuer Hochalpen known high precipitation rates cold temperatures. complex topography region leads high regional climatic variability challenging climate models simulate.","code":""},{"path":"https://henrifnk.github.io/VBC/articles/vbc_alps.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"VBC in the Alps: Multivariate Bias Correction and Evaluation","text":"exemplary showcases potentials VBC package correct bias climate model data Allgäuer Hochalpen 2011 2020 5 key climate variables. error prone data consists 50 member regional climate model large ensemble, CRCM5-LE 12km resolution. mp_dts contains model data projection (2011 - 2020), mc_dts model data calibration period (1981 - 2010). CRCM-5 data corrected using SDCLIREF version2 reference data 12km resolution. reference data oc_dt used correct model data. op_dt contains targeted distribution held elevation purposes. information, see Henri Funk, Ralf Ludwig, Helmut Küchenhoff, Thomas Nagler, Towards realistic climate model outputs: multivariate bias correction based zero-inflated vine copulas, Journal Royal Statistical Society Series C: Applied Statistics, 2025;, qlaf044, https://doi.org/10.1093/jrsssc/qlaf044. Lehr- und Forschungseinheit für physische Geographie und komplexe Umweltsysteme, & Wood, R. R. (2024). SDCLIREFv2 (Version 2) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.13221576 Funk, H. (2024). Bias Correction CRCM5-LE Hydrological Bavaria (1.0.0) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.13348397","code":"temp_file <- tempfile(fileext = \".rda\") url = \"https://zenodo.org/records/13348397/files/PEG-Iller-Kempten_14_12.rda?download=1\" download.file(url, temp_file, quiet = TRUE) load(temp_file) unlink(temp_file)"},{"path":"https://henrifnk.github.io/VBC/articles/vbc_alps.html","id":"bias-correction","dir":"Articles","previous_headings":"Data","what":"Bias Correction","title":"VBC in the Alps: Multivariate Bias Correction and Evaluation","text":"bias correction performed using VBC package. demonstration purposes, bias correction performed winter nights Allgäuer Hochalpen. winter nights defined hours 21:00 06:00 months December, January, February. showcase bias correction first 5 members CRCM5-LE. Therefore subset model data. correct winter nights first 5 members CRCM5-LE, use vbc_tsub function. function corrects model data using reference data oc_dt. marginal distributions, specify lower bound xmin type marginal distribution type. type c indicates continuous distribution, zi indicates zero-inflated distribution. bias correction performed using TLL family vine copulas. truncation level set infinity. function now efficiently corrects model data temporal subset t_subs member split_mp.","code":"winter_night = list(   nightDJF = list(hours = c(21, 0, 3, 6), month = c(12, 1, 2)) ) members <- mp_dts$member mem_5 = c(\"kba\", \"kbb\", \"kbc\", \"kbd\", \"kbe\") members = members[members %in% mem_5] mp_dts = mp_dts[member %in% mem_5, ][, member := NULL] mc_dts = mc_dts[member %in% mem_5, ][, member := NULL] split_mp <- split(mp_dts, members) margins_controls = list(   xmin = c(NaN, 0, NaN, 0, 0), type = c(\"c\", \"zi\", \"c\", \"zi\", \"c\") ) vbc = vbc_tsub(mp = split_mp, mc = mc_dts, rc = oc_dt, t_subs = winter_night,                margins_controls = margins_controls, family_set = \"tll\",                trunc_lvl = Inf) #> An ensemble member is done. #> An ensemble member is done. #> An ensemble member is done. #> An ensemble member is done. #> An ensemble member is done. #> subset for 21036 hours and 1212 month done."},{"path":[]},{"path":"https://henrifnk.github.io/VBC/articles/vbc_alps.html","id":"distributional-similarity","dir":"Articles","previous_headings":"Data > Evaluation","what":"Distributional Similarity","title":"VBC in the Alps: Multivariate Bias Correction and Evaluation","text":"bias correction evaluated comparing corrected model data reference data op_dt. Using plot_tails, VBC provides visual tool compare marginal distribution climate variable bias correction target reference data. Ideally, corrected model data close possible reference data.  quantify improvement bias correction, calculate Wasserstein distance corrected model data reference. Wasserstein distance measure distance two probability distributions. univariate level dew point temperature, bias correction improves model data 5 members CRCM5-LE. global multivariate distribution, bias correction improves model data 5 members 6th 2nd Wasserstein Distance constant level 1.","code":"plot_tails(mp_dts[hour(time) %in% c(21, 0, 3, 6) &                     month(time) %in% c(12, 1, 2), ], \"dew\", scale_d = 5,            mult = 1) + theme +   ggtitle(\"Pre-Correction\") + ylab(\"\") + xlab(\"\") +   theme(legend.position = \"none\") +   plot_tails(rbindlist(vbc), \"dew\", scale_d = 5, mult = 1) + theme +   ggtitle(\"Post-Correction\") + xlab(\"\") +   plot_tails(op_dt[hour(time) %in% c(21, 0, 3, 6) &                      month(time) %in% c(12, 1, 2), ], \"dew\", scale_d = 5,              mult = 1) + theme + ylab(\"\") +    xlab(\"Dewpoint Temperature in °C\") +   ggtitle(\"Reference\") + theme(legend.position = \"none\") +   plot_layout(ncol = 1) wd_post = sapply(vbc, function(mem) {   calc_wasserstein(op_dt[hour(time) %in% c(21, 0, 3, 6) &                            month(time) %in% c(12, 1, 2), 3], mem[, 3],                    , scale_dta = \"none\") })   wd_pre = sapply(split_mp, function(mem) {   calc_wasserstein(op_dt[hour(time) %in% c(21, 0, 3, 6) &                            month(time) %in% c(12, 1, 2), 3],                    mem[hour(time) %in% c(21, 0, 3, 6) &                          month(time) %in% c(12, 1, 2), 3],                    scale_dta = \"none\") })  improvement = wd_pre[2, ] - wd_post[2,] kable(cbind(\"WD2 pre correction\" = wd_pre[2, ],             \"WD2 post correction\" = wd_post[2,],             \"imporvement after correction\" = improvement), digits = 2) wd_post = sapply(vbc, function(mem) {   calc_wasserstein(op_dt[hour(time) %in% c(21, 0, 3, 6) &                            month(time) %in% c(12, 1, 2), 1:5], mem[, 1:5]) })  wd_pre = sapply(split_mp, function(mem) {   calc_wasserstein(op_dt[hour(time) %in% c(21, 0, 3, 6) &                            month(time) %in% c(12, 1, 2), 1:5],                    mem[hour(time) %in% c(21, 0, 3, 6) &                          month(time) %in% c(12, 1, 2), 1:5]) }) improvement = wd_pre - wd_post kable(cbind(\"WD2 pre correction\" = wd_pre[2, ],             \"WD2 post correction\" = wd_post[2,],             \"imporvement after correction\" = improvement[2,]), digits = 2)"},{"path":"https://henrifnk.github.io/VBC/articles/vbc_alps.html","id":"preservation-of-weather","dir":"Articles","previous_headings":"Data > Evaluation","what":"Preservation of Weather","title":"VBC in the Alps: Multivariate Bias Correction and Evaluation","text":"correcting model data, important bias correction method preserves course weather patterns model data. way original characteristics climate model still maintained. MCI measure preservation weather patterns. MCI first 5 members CRCM5-LE winter nights 2019 mostly 0 0.1. MCI 0 indicates non-invasive bias correction change course weather patterns model data. MCI limited [0,1][0, 1] indicating maximal change course weather.  average MCI corrected time series can used global assessment correction. median inconsistency 0.03, can assume weather winter nights 2019/2020 mainly preserved.","code":"mci = mapply(function(before, after) {   idx = which(hour(before$time) %in% c(21, 0, 3, 6) &                      month(before$time) %in% c(12, 1, 2))   calc_mci(before[idx, 1:5],after[, 1:5],            time_p = before$time[idx])$mci }, before = split_mp, after = vbc) mci = cbind.data.frame(mci, time = vbc[[1]]$time) mci$median = apply(mci[, 1:5], 1, median) mci2020 = mci[mci$time > \"2019-11-01\" & mci$time < \"2020-03-01\", ] ggplot(mci2020, aes(x = time)) +   geom_line(mapping = aes(y = kba), colour = \"lightblue\", linewidth = 0.3) +   geom_line(mapping = aes(y = kbb), colour = \"lightblue\", linewidth = 0.3) +   geom_line(mapping = aes(y = kbc), colour = \"lightblue\", linewidth = 0.3) +   geom_line(mapping = aes(y = kbd), colour = \"lightblue\", linewidth = 0.3) +   geom_line(mapping = aes(y = kbe), colour = \"lightblue\", linewidth = 0.3) +   geom_line(mapping = aes(y = median), colour = \"navyblue\") +    geom_hline(yintercept = 0, linetype = \"dashed\", colour = \"lightgreen\") +   theme_light() + theme +   labs(     caption = \"MCI of the first 5 members of the CRCM5-LE (lightblue) and their median (navyblue) during winter nights 2019\",     x = \"Time\", y = \"MCI\") kable(cbind(median = apply(mci[, 1:5], 2, median),             sd = apply(mci[, 1:5], 2, sd)), digits = 3)"},{"path":"https://henrifnk.github.io/VBC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Henri Funk. Author, maintainer.","code":""},{"path":"https://henrifnk.github.io/VBC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Funk H (2025). VBC: Vine Copula based Bias Correction Climate Models. R package version 1.0.0, https://henrifnk.github.io/VBC/.","code":"@Manual{,   title = {VBC: Vine Copula based Bias Correction for Climate Models},   author = {Henri Funk},   year = {2025},   note = {R package version 1.0.0},   url = {https://henrifnk.github.io/VBC/}, }"},{"path":"https://henrifnk.github.io/VBC/index.html","id":"bias-correction-by-zero-inflated-vine-copulas-","dir":"","previous_headings":"","what":"Vine Copula based Bias Correction for Climate Models","title":"Vine Copula based Bias Correction for Climate Models","text":"Vine Copula Bias Correction (VBC) multivariate bias correction methodology grounded vine copula theory. method generalizes marginal distributions, copulas, vine copula densities accommodate mixture distributions, extends Rosenblatt transform handle non-continuous pseudo-observations. allows VBC model dependencies among heavy-tailed, zero-inflated, continuous climate variables high temporal resolution, providing accurate robust corrections. key feature VBC interpretability: users can transparently control correction process assess outcomes using built-diagnostics. full methodological details, please see paper.","code":""},{"path":"https://henrifnk.github.io/VBC/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Vine Copula based Bias Correction for Climate Models","text":"","code":"# without vignette remotes::install_github(\"henrifnk/VBC\") # with vignette remotes::install_github(\"henrifnk/VBC\", build_vignettes = TRUE)"},{"path":"https://henrifnk.github.io/VBC/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Vine Copula based Bias Correction for Climate Models","text":"aim correct CRCM5 climate data Munich, Germany, year 2010. data available package climate. use vbc function correct data. Climate data available 3-hourly resolution variables temperature, precipitation, dew point temperature, radiation wind speed. high temporal resolution causes inflation variables radiation precipitation. Visually, check shape marginal distributions model data reference data using plot_tails. distance two marginal distributions can quantified using Wasserstein distance.  correction, need specify type margins limits. \"zi\" defines univariate margins \"c\" strictly continuous margin. xmin specifies lower bound margins. vine copula modeling, use TLL family set truncation vine. can visually quantitatively asses correction mp_vbc comparing corrected data reference data plotting tails calculating Wasserstein distances. results can compared .  Visibly, correction shortens heavy tail increases density inflation zero. also reflected Wasserstein distance. can quantify multivariate improvement correction terms Wasserstein distances.","code":"library(data.table) library(ggplot2) library(knitr) library(patchwork) library(VBC)  data(\"climate\")  climate_2010 = lapply(climate, function(data) data[year(time) == 2010, ]) plot_tails(climate_2010$mp, \"pr\", scale_d = 0.1, mult = 4, xmin = 0) +   labs(x = \"\", title = \"Marginal distribution of uncorrected model data\") +   theme(legend.position = \"none\") +   plot_tails(climate_2010$rp, \"pr\", scale_d = 1, mult = 4, xmin = 0) +   labs(x = \"precipitation (mm/h)\",          title = \"Marginal targeted distribution of reference data\") +   scale_y_continuous(name = \"\") +   plot_layout(ncol = 1) wd_pre = calc_wasserstein(climate_2010$mp[, \"pr\"], climate_2010$rp[, \"pr\"]) wd_pre #> Wasserstein_1 Wasserstein_2  #>    0.05947432    0.21964470 plot_tails(round(mp_vbc, 3), \"pr\", scale_d = 1, mult = 3, xmin = 0) +   labs(x = \"precipitation (mm/h)\",        title = \"Marginal distribution of corrected model data\") wd_post = calc_wasserstein(climate_2010$rp[, \"pr\"], mp_vbc[, \"pr\"])  kable(data.frame(\"Wasserstein_Uncorrected\" = wd_pre,                  \"Wasserstein_Corrected\" = wd_post,                  \"Improvement\" = wd_pre - wd_post,                  \"Improvement_in_Perc\" = (wd_pre - wd_post) / wd_pre * 100),       digits = 2) wd_mvd_post = calc_wasserstein(climate_2010$rp[, -\"time\"], mp_vbc) wd_mvd_pre = calc_wasserstein(climate_2010$rp[, -\"time\"],                               climate_2010$mp[, -\"time\"]) iprovement = wd_mvd_pre - wd_mvd_post  kable(data.frame(\"Wasserstein_Uncorrected\" = wd_mvd_pre,                  \"Wasserstein_Corrected\" = wd_mvd_post,                  \"Improvement\" = iprovement,                  \"Improvement_in_Perc\" = iprovement / wd_mvd_pre * 100),       digits = 2)"},{"path":"https://henrifnk.github.io/VBC/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Vine Copula based Bias Correction for Climate Models","text":"use VBC scientific publication, please cite : BibTeX:","code":"Henri Funk, Ralf Ludwig, Helmut Küchenhoff, Thomas Nagler, Towards more realistic climate model outputs: a multivariate bias correction based on zero-inflated vine copulas, Journal of the Royal Statistical Society Series C: Applied Statistics, 2025;, qlaf044, https://doi.org/10.1093/jrsssc/qlaf044 @article{funk2025,     author = {Funk, Henri and Ludwig, Ralf and Küchenhoff, Helmut and Nagler, Thomas},     title = {Towards more realistic climate model outputs: a multivariate bias correction based on zero-inflated vine copulas},     journal = {Journal of the Royal Statistical Society Series C: Applied Statistics},     pages = {qlaf044},     year = {2025},     month = {08},     issn = {0035-9254},     doi = {10.1093/jrsssc/qlaf044},     url = {https://doi.org/10.1093/jrsssc/qlaf044},     eprint = {https://academic.oup.com/jrsssc/advance-article-pdf/doi/10.1093/jrsssc/qlaf044/64045829/qlaf044.pdf}, }"},{"path":"https://henrifnk.github.io/VBC/reference/calc_mci.html","id":null,"dir":"Reference","previous_headings":"","what":"Model Correction Inconsistency (MCI) — calc_mci","title":"Model Correction Inconsistency (MCI) — calc_mci","text":"MCI provides score quantify invasive correction method transformed multivariate temporal rank structure model correcting model bias. Therefore, model compares non-exceedance probabilities event t bias correction. non-invasive method preserves model-specific rank structure.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_mci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model Correction Inconsistency (MCI) — calc_mci","text":"","code":"calc_mci(model, model_correction, time_p = NA, p = 1)"},{"path":"https://henrifnk.github.io/VBC/reference/calc_mci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model Correction Inconsistency (MCI) — calc_mci","text":"model data.frame Simulation climate data climate model. model_correction data.frame Simulation climate data model climate model corrected arbitrary bias correction method. time_p date optional vector time point observation/row (corrected) model data. Default NA indicates temporal information given. p numeric(1) power global MCI. Default 1.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_mci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model Correction Inconsistency (MCI) — calc_mci","text":"data.table Contains points time supplied time_p respective local MCI. Note last time step truncated derivation. attribute global contains global MCI, mean MCI scores. estimated multivariate distribution model correction placed attributes returned object.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_mci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model Correction Inconsistency (MCI) — calc_mci","text":"","code":"#' \\dontrun{ #' # Start with a simple example: #' # There is one timeline that should be corrected and projection and  #' # calibaration period are both in 2010. #' set.seed(1234L) #' library(VBC) #' library(data.table) #' library(patchwork) #' data(\"climate\") #' margins_controls <- list(xmin = c(NaN, 0, NaN, 0, 0), #'                          type = c(\"c\", \"zi\", \"c\", \"zi\", \"c\")) #'                    #' climate_2010 = lapply(climate, function(data) data[year(time) == 2010, ]) #'  #' mp_vbc = vbc(climate_2010$mp[, -\"time\"], climate_2010$mp[, -\"time\"], #'              climate_2010$rp[, -\"time\"], margins_controls = margins_controls, #'              family_set = \"tll\", trunc_lvl = Inf)                  #'  #' plot_tails(climate_2010$mp, \"pr\", scale_d = 0.1, mult = 4, xmin = 0)  #' plot_tails(climate_2010$rp, \"pr\", scale_d = 1, mult = 4, xmin = 0) #' plot_tails(round(mp_vbc, 3), \"pr\", scale_d = 1, mult = 3, xmin = 0) #' calc_wasserstein(climate_2010$mp[, \"pr\"], climate_2010$rp[, \"pr\"]) #' calc_wasserstein(climate_2010$rp[, \"pr\"], mp_vbc[, \"pr\"]) #'  #' calc_wasserstein(climate_2010$rp[, -\"time\"], climate_2010$mp[, -\"time\"]) #' calc_wasserstein(climate_2010$rp[, -\"time\"], mp_vbc) #'  #' # An example with temporal subsetting using the method of fragments #'   #' temp_subs <- list(DJF = list(hours = seq(0, 21, 3), month = c(12, 1, 2)), #'                   MAM = list(hours = seq(0, 21, 3), month = 3:5), #'                   JJA = list(hours = seq(0, 21, 3), month = 6:8), #'                   SON = list(hours = seq(0, 21, 3), month = 9:11))   #'                                   #' mp_vbc = vbc_tsub(climate$mp, climate$mc, climate$rc, t_subs = temp_subs, #'                   margins_controls = margins_controls, family_set = \"tll\", #'                   trunc_lvl = Inf) #' class(mp_vbc) #' attr(mp_vbc, \"mvd\") #'  #' measure = lapply(temp_subs, function(sub) { #'    idx = which(hour(mp_vbc$time) %in% sub$hour & #'                   month(mp_vbc$time) %in% sub$month) #'    idxrp = which(hour(climate$rp$time) %in% sub$hour & #'                      month(climate$rp$time) %in% sub$month) #'    mci = calc_mci(climate$mp[idx, -\"time\"], mp_vbc[idx, -\"time\"], #'                     time = climate$mp$time[idx]) #'    mci = attr(mci, \"global_mci\") #'     #'    uncorrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                     climate$mp[idx, -\"time\"]) #'    corrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                 mp_vbc[idx, -\"time\"]) #'    data.table( #'        ModelCorrectionInconsistancy = mci, #'        Wasserstein2_uncorrected = uncorrected[2], #'        Wasserstein2_corrected = corrected[2], #'        Improvement_Wasserstein2 = uncorrected[2] - corrected[2],  #'        month = paste(sub$month, collapse = \"-\") #'        ) #' }) #' rbindlist(measure) #' }"},{"path":"https://henrifnk.github.io/VBC/reference/calc_range.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate temporal range recursively by overlap. — calc_range","title":"calculate temporal range recursively by overlap. — calc_range","text":"calculate temporal range recursively overlap.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate temporal range recursively by overlap. — calc_range","text":"","code":"calc_range(v, min, max, res, overlap = 1)"},{"path":"https://henrifnk.github.io/VBC/reference/calc_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate temporal range recursively by overlap. — calc_range","text":"v sorted vector temporal indicators min cyclic minimum max cyclic maximum res resolution time overlap integer number times overlap temporal indicators.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate temporal range recursively by overlap. — calc_range","text":"vector temporal indicators","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_wasserstein.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Wasserstein Distance — calc_wasserstein","title":"Calculate Wasserstein Distance — calc_wasserstein","text":"Calculate Wasserstein distance order 1 2 multivariate distributions model observed data. Can used evaluate performance bias correction method comparing distribution model data correction.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_wasserstein.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Wasserstein Distance — calc_wasserstein","text":"","code":"calc_wasserstein(   observed,   model,   n = nrow(observed),   scale_dta = \"observed\",   ... )"},{"path":"https://henrifnk.github.io/VBC/reference/calc_wasserstein.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Wasserstein Distance — calc_wasserstein","text":"observed data.frame Measured (interpolated) observations. model data.frame Simulation climate data climate model. n integer(1) Length samples drawn model observed data. scale_dta cahracter(1) Scale data calculating Wasserstein distance. Default \"observed\". Possible values \"\", \"observed\", \"sd\". \"\" data scaled zero mean unit variance. \"observed\" data scaled zero mean unit variance observed data. \"sd\" data scaled zero mean unit variance. ... arguments passed transport::transport.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calc_wasserstein.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Wasserstein Distance — calc_wasserstein","text":"named vector length 2. Wasserstein_1: Wasserstein distance order 1 Wasserstein_2: Wasserstein distance order 2","code":""},{"path":[]},{"path":"https://henrifnk.github.io/VBC/reference/calc_wasserstein.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Wasserstein Distance — calc_wasserstein","text":"","code":"#' \\dontrun{ #' # Start with a simple example: #' # There is one timeline that should be corrected and projection and  #' # calibaration period are both in 2010. #' set.seed(1234L) #' library(VBC) #' library(data.table) #' library(patchwork) #' data(\"climate\") #' margins_controls <- list(xmin = c(NaN, 0, NaN, 0, 0), #'                          type = c(\"c\", \"zi\", \"c\", \"zi\", \"c\")) #'                    #' climate_2010 = lapply(climate, function(data) data[year(time) == 2010, ]) #'  #' mp_vbc = vbc(climate_2010$mp[, -\"time\"], climate_2010$mp[, -\"time\"], #'              climate_2010$rp[, -\"time\"], margins_controls = margins_controls, #'              family_set = \"tll\", trunc_lvl = Inf)                  #'  #' plot_tails(climate_2010$mp, \"pr\", scale_d = 0.1, mult = 4, xmin = 0)  #' plot_tails(climate_2010$rp, \"pr\", scale_d = 1, mult = 4, xmin = 0) #' plot_tails(round(mp_vbc, 3), \"pr\", scale_d = 1, mult = 3, xmin = 0) #' calc_wasserstein(climate_2010$mp[, \"pr\"], climate_2010$rp[, \"pr\"]) #' calc_wasserstein(climate_2010$rp[, \"pr\"], mp_vbc[, \"pr\"]) #'  #' calc_wasserstein(climate_2010$rp[, -\"time\"], climate_2010$mp[, -\"time\"]) #' calc_wasserstein(climate_2010$rp[, -\"time\"], mp_vbc) #'  #' # An example with temporal subsetting using the method of fragments #'   #' temp_subs <- list(DJF = list(hours = seq(0, 21, 3), month = c(12, 1, 2)), #'                   MAM = list(hours = seq(0, 21, 3), month = 3:5), #'                   JJA = list(hours = seq(0, 21, 3), month = 6:8), #'                   SON = list(hours = seq(0, 21, 3), month = 9:11))   #'                                   #' mp_vbc = vbc_tsub(climate$mp, climate$mc, climate$rc, t_subs = temp_subs, #'                   margins_controls = margins_controls, family_set = \"tll\", #'                   trunc_lvl = Inf) #' class(mp_vbc) #' attr(mp_vbc, \"mvd\") #'  #' measure = lapply(temp_subs, function(sub) { #'    idx = which(hour(mp_vbc$time) %in% sub$hour & #'                   month(mp_vbc$time) %in% sub$month) #'    idxrp = which(hour(climate$rp$time) %in% sub$hour & #'                      month(climate$rp$time) %in% sub$month) #'    mci = calc_mci(climate$mp[idx, -\"time\"], mp_vbc[idx, -\"time\"], #'                     time = climate$mp$time[idx]) #'    mci = attr(mci, \"global_mci\") #'     #'    uncorrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                     climate$mp[idx, -\"time\"]) #'    corrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                 mp_vbc[idx, -\"time\"]) #'    data.table( #'        ModelCorrectionInconsistancy = mci, #'        Wasserstein2_uncorrected = uncorrected[2], #'        Wasserstein2_corrected = corrected[2], #'        Improvement_Wasserstein2 = uncorrected[2] - corrected[2],  #'        month = paste(sub$month, collapse = \"-\") #'        ) #' }) #' rbindlist(measure) #' }"},{"path":"https://henrifnk.github.io/VBC/reference/calculate_pemp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Non-Exceedance Probability — calculate_pemp","title":"Calculate Non-Exceedance Probability — calculate_pemp","text":"Calculate Non-Exceedance Probability","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calculate_pemp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Non-Exceedance Probability — calculate_pemp","text":"","code":"calculate_pemp(data)"},{"path":"https://henrifnk.github.io/VBC/reference/calculate_pemp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Non-Exceedance Probability — calculate_pemp","text":"data data.table rows data.table, non-exceedance probability calculated.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/calculate_pemp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Non-Exceedance Probability — calculate_pemp","text":"data frame non-exceedance probability events. non-exceedance probability percentage rows satisfy condition values row less equal values row.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/check_vbc_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Check arguments for vine correction — check_vbc_args","title":"Check arguments for vine correction — check_vbc_args","text":"Check arguments vine correction","code":""},{"path":"https://henrifnk.github.io/VBC/reference/check_vbc_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check arguments for vine correction — check_vbc_args","text":"","code":"check_vbc_args(mp, mc, rc, var_names)"},{"path":"https://henrifnk.github.io/VBC/reference/check_vbc_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check arguments for vine correction — check_vbc_args","text":"mp data.table list Simulation data climate model projection period. list, algorithm expects element member model ensemble. list element data table. mc data.table Simulation data climate model calibration period. rc data.table Historical reference calibration period. var_names character Names corrected climate data. Defaults column names observed data rc.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/climate.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample CRCM5 and SDCLIREF data — climate","title":"Sample CRCM5 and SDCLIREF data — climate","text":"Sample CRCM5-LE member \"kba\" SDCLIREF v1 data city Munich (48°8'14.75\"N, 11°34'31.76\"E).","code":""},{"path":"https://henrifnk.github.io/VBC/reference/climate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample CRCM5 and SDCLIREF data — climate","text":"","code":"climate"},{"path":"https://henrifnk.github.io/VBC/reference/climate.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample CRCM5 and SDCLIREF data — climate","text":"list four elements mp Simulation data model projection period. mc Simulation data model calibration period. rp Measured observations projection period. rc Measured observations calibration period.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/climate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample CRCM5 and SDCLIREF data — climate","text":"Data available 3 hourly resolution : 01.01.2005 - 31.12.2007 calibration 01.01.2008 - 31.12-2010 projection. 5 climate variables correct: tas: average surface temperature (deg. C) pr: precipitation (mm day-1) dew: dewpoint temperature (deg. C) rsds: surface downwelling shortwave radiation (W m-2) sfcWind: surface wind speed (m s-1) time: date time three hourly resolution","code":""},{"path":"https://henrifnk.github.io/VBC/reference/climate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sample CRCM5 and SDCLIREF data — climate","text":"Leduc, M., Mailhot, ., Frigon, ., Martel, J. L., Ludwig, R., Brietzke, G. B., ... & Scinocca, J. (2019). ClimEx project: 50-member ensemble climate change projections 12-km resolution Europe northeastern North America Canadian Regional Climate Model (CRCM5). Journal Applied Meteorology Climatology, 58(4), 663-693. Wood, R. R., Willkofer, F., Schmid, F. J., Trentini, F., Komischke, H., & Ludwig, R. (2017, April). SDCLIREF-sub-daily reference dataset. EGU General Assembly Conference Abstracts (p. 15739).","code":""},{"path":"https://henrifnk.github.io/VBC/reference/correct_rosenblatt.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct data by Rosenblatt transformation — correct_rosenblatt","title":"Correct data by Rosenblatt transformation — correct_rosenblatt","text":"Correct data Rosenblatt transformation","code":""},{"path":"https://henrifnk.github.io/VBC/reference/correct_rosenblatt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct data by Rosenblatt transformation — correct_rosenblatt","text":"","code":"correct_rosenblatt(mpu, rcu)"},{"path":"https://henrifnk.github.io/VBC/reference/correct_rosenblatt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct data by Rosenblatt transformation — correct_rosenblatt","text":"mpu data.table Model data vbc(). rcu data.table Observed data vbc().","code":""},{"path":"https://henrifnk.github.io/VBC/reference/correct_rosenblatt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct data by Rosenblatt transformation — correct_rosenblatt","text":"Corrected data Rosenblatt transformation.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/estimate_margins.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Margins — estimate_margins","title":"Estimate Margins — estimate_margins","text":"Estimate Margins","code":""},{"path":"https://henrifnk.github.io/VBC/reference/estimate_margins.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Margins — estimate_margins","text":"","code":"estimate_margins(dta, margins_controls, kde = NULL)"},{"path":"https://henrifnk.github.io/VBC/reference/estimate_margins.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Margins — estimate_margins","text":"dta data.table Data calculate margins. margins_controls list list arguments passed kde1d::kde1d(). Currently, can mult numeric vector length one d; bandwidths marginal kernel density estimation multiplied mult. Defaults log(1 + d) d number climate variables. xmin numeric vector length d; see kde1d::kde1d(). xmax numeric vector length d; see kde1d::kde1d(). bw numeric vector length d; see kde1d::kde1d(). deg numeric vector length one d; kde1d::kde1d(). type character vector length one d; must one c, cont, continuous continuous variables, one d, disc, discrete discrete integer variables, one zi, zinfl, zero-inflated zero-inflated variables. kde list kernel density estimations.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/estimate_margins.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Margins — estimate_margins","text":"data frame marginal PIT.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/expand_margin_controls.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand margins — expand_margin_controls","title":"Expand margins — expand_margin_controls","text":"Expand margins","code":""},{"path":"https://henrifnk.github.io/VBC/reference/expand_margin_controls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand margins — expand_margin_controls","text":"","code":"expand_margin_controls(controls, dta)"},{"path":"https://henrifnk.github.io/VBC/reference/expand_margin_controls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand margins — expand_margin_controls","text":"controls margins_controls dta data.table Data calculate margins.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/expand_margin_controls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand margins — expand_margin_controls","text":"Expanded margins.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/invert_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Invert a list — invert_list","title":"Invert a list — invert_list","text":"Invert list","code":""},{"path":"https://henrifnk.github.io/VBC/reference/invert_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Invert a list — invert_list","text":"","code":"invert_list(list)"},{"path":"https://henrifnk.github.io/VBC/reference/invert_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Invert a list — invert_list","text":"list list list depth 2. first depth indicates temporal subset second depth members model ensemble.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/invert_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Invert a list — invert_list","text":"list list depth 2. first depth indicates members model ensemble second depth temporal subset.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/map_delta.html","id":null,"dir":"Reference","previous_headings":"","what":"Delta mapping — map_delta","title":"Delta mapping — map_delta","text":"Map rank delta model calibration period mc projection period mp corrected projection period mph correct climate trends. climate variables bounded 0, multiplicative delta scheme applied projection quantiles lower calibration quantiles.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/map_delta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delta mapping — map_delta","text":"","code":"map_delta(mp, mph, mp_kde, mc_kde, xmin = NA)"},{"path":"https://henrifnk.github.io/VBC/reference/map_delta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delta mapping — map_delta","text":"mp double uncorrected climate variable projection period. mph double corrected climate variable projection period. mp_kde kde1d::kde1d kernel density estimation climate variable projection period. mc_kde kde1d::kde1d kernel density estimation climate variable calibration period. xmin double(1) vector indicating xmin ratio variable type type (NA).","code":""},{"path":"https://henrifnk.github.io/VBC/reference/map_delta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delta mapping — map_delta","text":"climate variable corrected climate trend model correction projection period.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/model_vine.html","id":null,"dir":"Reference","previous_headings":"","what":"Model Multivariate Distribution by Vine Copula — model_vine","title":"Model Multivariate Distribution by Vine Copula — model_vine","text":"Estimate multivariate distribution model data via vine copula estimation (see rvinecopulib::vine).","code":""},{"path":"https://henrifnk.github.io/VBC/reference/model_vine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model Multivariate Distribution by Vine Copula — model_vine","text":"","code":"model_vine(data, margins_controls, ...)"},{"path":"https://henrifnk.github.io/VBC/reference/model_vine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model Multivariate Distribution by Vine Copula — model_vine","text":"data data.frame Data estimate multivariate distribution. margins_controls list list arguments passed kde1d::kde1d(). Currently, can mult numeric vector length one d; bandwidths marginal kernel density estimation multiplied mult. Defaults log(1 + d) d number climate variables. xmin numeric vector length d; see kde1d::kde1d(). xmax numeric vector length d; see kde1d::kde1d(). bw numeric vector length d; see kde1d::kde1d(). deg numeric vector length one d; kde1d::kde1d(). type character vector length one d; must one c, cont, continuous continuous variables, one d, disc, discrete discrete integer variables, one zi, zinfl, zero-inflated zero-inflated variables. ... Arguments passed rvinecopulib::vinecop specify structure vines margins. Note ellipsis observed model data specified arguments.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/model_vine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model Multivariate Distribution by Vine Copula — model_vine","text":"PIT-transformed margins estimate_margins(). Additionally data frame contains attribute vine vine copula model attribute kde kernel density estimation data.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/plot_tails.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Tails — plot_tails","title":"Plot Tails — plot_tails","text":"function plots tails probabilities marginal distribution.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/plot_tails.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Tails — plot_tails","text":"","code":"plot_tails(data, var, xmin = NA, scale_d = 3, mult = 1, length_out = 10000)"},{"path":"https://henrifnk.github.io/VBC/reference/plot_tails.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Tails — plot_tails","text":"data data.table data.table containing data plotted. var character variable plotted. Must column data. xmin numeric minimum value variable plotted. Passed kde1d. Default NA indicating lower limit. scale_d numeric scaling factor density plot continuous relative axis. Default 3. Regulate factor, continuous density estimates relative frequency distinct y-axis. used zero inflated variables. mult numeric Bin width multiplier. Passed kde1d. Default 1 indicating multiplication. length_out numeric length sequence used density plot. Default 1e4.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/plot_tails.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Tails — plot_tails","text":"ggplot plots continuous density estimate variable relative frequency inflation.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/rosenblatt.html","id":null,"dir":"Reference","previous_headings":"","what":"Rosenblatt transformation — rosenblatt","title":"Rosenblatt transformation — rosenblatt","text":"Rosenblatt transformation method transform uniform pseudo-observations original scale data, preserving copula structure. Adapted rvinecopulib::rosenblatt() rvinecopulib::inverse_rosenblatt().","code":""},{"path":"https://henrifnk.github.io/VBC/reference/rosenblatt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rosenblatt transformation — rosenblatt","text":"","code":"rosenblatt(x, model, cores = 1, randomize_discrete = TRUE)"},{"path":"https://henrifnk.github.io/VBC/reference/rosenblatt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rosenblatt transformation — rosenblatt","text":"x numeric matrix data.frame observations. \\([0,1]^d\\), converted via rvinecopulib::pseudo_obs() unless already provided pseudo-observations. model vinecop object (rvinecopulib) describing dependence structure. cores Integer; number threads use. Default: 1. randomize_discrete Logical; TRUE, apply jittering/randomized PIT discrete/mixture margins (Rosenblatt non-continuous margins). Default: FALSE.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/rosenblatt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rosenblatt transformation — rosenblatt","text":"numeric matrix dimension x, containing PIT-transformed values \\([0,1]\\).","code":""},{"path":"https://henrifnk.github.io/VBC/reference/subset_time.html","id":null,"dir":"Reference","previous_headings":"","what":"subset time and final reading index — subset_time","title":"subset time and final reading index — subset_time","text":"subset time final reading index","code":""},{"path":"https://henrifnk.github.io/VBC/reference/subset_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"subset time and final reading index — subset_time","text":"","code":"subset_time(data, hrs, mnt, overlap = 1)"},{"path":"https://henrifnk.github.io/VBC/reference/subset_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"subset time and final reading index — subset_time","text":"data data.frame Data estimate multivariate distribution. hrs integer hours day used subsetting. mnt integer months year used subsetting. overlap integer number times overlap temporal indicators.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":null,"dir":"Reference","previous_headings":"","what":"Correct zero inflated climate model simulations via vine copulas — vbc","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"multivariate distribution functions model observed estimated via vine copula estimation (see rvinecopulib::vine). method provides tool model multivariate distribution function climate data Vine Copulas. climate variables may zero inflated. quantiles mapped via (inverse) Rosenblatt transformation model observed distribution. corrected data mapped projection domain via delta mapping. steps equivalent univariate bias correction via quantile delta mapping.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"","code":"vbc(   mp,   mc,   rc,   var_names = colnames(rc),   margins_controls = list(mult = NULL, xmin = NaN, xmax = NaN, bw = NA, deg = 2, type =     \"c\"),   time_mp = NA,   ... )"},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"mp data.table list Simulation data climate model projection period. list, algorithm expects element member model ensemble. list element data table. mc data.table Simulation data climate model calibration period. rc data.table Historical reference calibration period. var_names character Names corrected climate data. Defaults column names observed data rc. margins_controls list list arguments passed kde1d::kde1d(). Currently, can mult numeric vector length one d; bandwidths marginal kernel density estimation multiplied mult. Defaults log(1 + d) d number climate variables. xmin numeric vector length d; see kde1d::kde1d(). xmax numeric vector length d; see kde1d::kde1d(). bw numeric vector length d; see kde1d::kde1d(). deg numeric vector length one d; kde1d::kde1d(). type character vector length one d; must one c, cont, continuous continuous variables, one d, disc, discrete discrete integer variables, one zi, zinfl, zero-inflated zero-inflated variables. time_mp numeric Time vector projection period attached returned object column. Defaults NA, means time vector attached. ... Arguments passed rvinecopulib::vinecop specify structure vines margins. Note ellipsis observed model data specified arguments.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"data.table list corrected projection period data mp. Additionally data frame contains attributes vine_rc, kde_rc, vine_mp, kde_mp store vine copula kernel density estimation objects observed model data. mp list, function returns list corrected data frames member model ensemble.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"Czado, C. (2019). Analyzing dependent data vine copulas. Lecture Notes Statistics, Springer, 222. Rosenblatt, M. (1952). Remarks multivariate transformation. annals mathematical statistics, 23(3), 470-472. Cannon, .J., S.R. Sobie, T.Q. Murdock, (2015). Bias correction simulated precipitation quantile mapping: well methods preserve relative changes quantiles extremes? Journal Climate, 28:6938-6959.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correct zero inflated climate model simulations via vine copulas — vbc","text":"","code":"#' \\dontrun{ #' # Start with a simple example: #' # There is one timeline that should be corrected and projection and  #' # calibaration period are both in 2010. #' set.seed(1234L) #' library(VBC) #' library(data.table) #' library(patchwork) #' data(\"climate\") #' margins_controls <- list(xmin = c(NaN, 0, NaN, 0, 0), #'                          type = c(\"c\", \"zi\", \"c\", \"zi\", \"c\")) #'                    #' climate_2010 = lapply(climate, function(data) data[year(time) == 2010, ]) #'  #' mp_vbc = vbc(climate_2010$mp[, -\"time\"], climate_2010$mp[, -\"time\"], #'              climate_2010$rp[, -\"time\"], margins_controls = margins_controls, #'              family_set = \"tll\", trunc_lvl = Inf)                  #'  #' plot_tails(climate_2010$mp, \"pr\", scale_d = 0.1, mult = 4, xmin = 0)  #' plot_tails(climate_2010$rp, \"pr\", scale_d = 1, mult = 4, xmin = 0) #' plot_tails(round(mp_vbc, 3), \"pr\", scale_d = 1, mult = 3, xmin = 0) #' calc_wasserstein(climate_2010$mp[, \"pr\"], climate_2010$rp[, \"pr\"]) #' calc_wasserstein(climate_2010$rp[, \"pr\"], mp_vbc[, \"pr\"]) #'  #' calc_wasserstein(climate_2010$rp[, -\"time\"], climate_2010$mp[, -\"time\"]) #' calc_wasserstein(climate_2010$rp[, -\"time\"], mp_vbc) #'  #' # An example with temporal subsetting using the method of fragments #'   #' temp_subs <- list(DJF = list(hours = seq(0, 21, 3), month = c(12, 1, 2)), #'                   MAM = list(hours = seq(0, 21, 3), month = 3:5), #'                   JJA = list(hours = seq(0, 21, 3), month = 6:8), #'                   SON = list(hours = seq(0, 21, 3), month = 9:11))   #'                                   #' mp_vbc = vbc_tsub(climate$mp, climate$mc, climate$rc, t_subs = temp_subs, #'                   margins_controls = margins_controls, family_set = \"tll\", #'                   trunc_lvl = Inf) #' class(mp_vbc) #' attr(mp_vbc, \"mvd\") #'  #' measure = lapply(temp_subs, function(sub) { #'    idx = which(hour(mp_vbc$time) %in% sub$hour & #'                   month(mp_vbc$time) %in% sub$month) #'    idxrp = which(hour(climate$rp$time) %in% sub$hour & #'                      month(climate$rp$time) %in% sub$month) #'    mci = calc_mci(climate$mp[idx, -\"time\"], mp_vbc[idx, -\"time\"], #'                     time = climate$mp$time[idx]) #'    mci = attr(mci, \"global_mci\") #'     #'    uncorrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                     climate$mp[idx, -\"time\"]) #'    corrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                 mp_vbc[idx, -\"time\"]) #'    data.table( #'        ModelCorrectionInconsistancy = mci, #'        Wasserstein2_uncorrected = uncorrected[2], #'        Wasserstein2_corrected = corrected[2], #'        Improvement_Wasserstein2 = uncorrected[2] - corrected[2],  #'        month = paste(sub$month, collapse = \"-\") #'        ) #' }) #' rbindlist(measure) #' }"},{"path":"https://henrifnk.github.io/VBC/reference/vbc_ensemble.html","id":null,"dir":"Reference","previous_headings":"","what":"Correction by VBC for model ensembles — vbc_ensemble","title":"Correction by VBC for model ensembles — vbc_ensemble","text":"Correction VBC model ensembles","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_ensemble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correction by VBC for model ensembles — vbc_ensemble","text":"","code":"vbc_ensemble(mp, mc, rc, var_names, margins_controls, time_mp, ...)"},{"path":"https://henrifnk.github.io/VBC/reference/vbc_ensemble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correction by VBC for model ensembles — vbc_ensemble","text":"mp data.table list Simulation data climate model projection period. list, algorithm expects element member model ensemble. list element data table. mc data.table Simulation data climate model calibration period. rc data.table Historical reference calibration period. var_names character Names corrected climate data. Defaults column names observed data rc. margins_controls list list arguments passed kde1d::kde1d(). Currently, can mult numeric vector length one d; bandwidths marginal kernel density estimation multiplied mult. Defaults log(1 + d) d number climate variables. xmin numeric vector length d; see kde1d::kde1d(). xmax numeric vector length d; see kde1d::kde1d(). bw numeric vector length d; see kde1d::kde1d(). deg numeric vector length one d; kde1d::kde1d(). type character vector length one d; must one c, cont, continuous continuous variables, one d, disc, discrete discrete integer variables, one zi, zinfl, zero-inflated zero-inflated variables. time_mp numeric Time vector projection period attached returned object column. Defaults NA, means time vector attached. ... Arguments passed rvinecopulib::vinecop specify structure vines margins. Note ellipsis observed model data specified arguments.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_ensemble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correction by VBC for model ensembles — vbc_ensemble","text":"list list corrected data frames member model ensemble.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine VBC and the Method of fragments — vbc_tsub","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"Combine VBC Method fragments","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"","code":"vbc_tsub(   mp,   mc,   rc,   var_names = colnames(rc),   margins_controls = list(mult = NULL, xmin = NaN, xmax = NaN, bw = NA, deg = 2, type =     \"c\"),   t_subs = list(list(hours = 0:23, month = 1:12)),   overlap = 1,   cores_t = NA,   verbose = TRUE,   ... )"},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"mp data.table Simulation data climate model projection period. Expects one column time. mc data.table Simulation data climate model calibration period. Expects one column time. rc data.table Measured (interpolated) observations calibration period. Expects one column time. var_names character Names corrected climate data. Defaults column names observed data rc. margins_controls list list arguments passed kde1d::kde1d(). Currently, can mult numeric vector length one d; bandwidths marginal kernel density estimation multiplied mult. Defaults log(1 + d) d number climate variables. xmin numeric vector length d; see kde1d::kde1d(). xmax numeric vector length d; see kde1d::kde1d(). bw numeric vector length d; see kde1d::kde1d(). deg numeric vector length one d; kde1d::kde1d(). type character vector length one d; must one c, cont, continuous continuous variables, one d, disc, discrete discrete integer variables, one zi, zinfl, zero-inflated zero-inflated variables. t_subs list list two lists: hours month. list contains temporal indicators subset data. first list contains hours day length list marks number fragments. inner list contains hour monthly information subset data. overlap integer number times overlap temporal indicators. cores_t integer number cores use parallel processing temporal subsetting. Default NA means parallel processing. verbose logical Print messages temporal subsetting. ... Arguments passed rvinecopulib::vinecop specify structure vines margins. Note ellipsis observed model data specified arguments.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"data.table corrected projection period data mp. Additionally data frame contains attribute mvd one list per temporal subset. subset vine_rc, kde_rc, vine_mp, kde_mp store vine copula kernel density estimation objects observed model data. time column attached data.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"Sharma, .; Srikanthan, S. (2006): Continuous Rainfall Simulation: Nonparametric Alternative. : 30th Hydrology Water Resources Symposium 4-7 December 2006, Launceston, Tasmania. Westra, S.; Mehrotra, R.; Sharma, .; Srikanthan, R. (2012): Continuous rainfall simulation. 1. regionalized subdaily disaggregation approach. : Water Resour. Res. 48 (1). DOI: 10.1029/2011WR010489.","code":""},{"path":"https://henrifnk.github.io/VBC/reference/vbc_tsub.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine VBC and the Method of fragments — vbc_tsub","text":"","code":"#' \\dontrun{ #' # Start with a simple example: #' # There is one timeline that should be corrected and projection and  #' # calibaration period are both in 2010. #' set.seed(1234L) #' library(VBC) #' library(data.table) #' library(patchwork) #' data(\"climate\") #' margins_controls <- list(xmin = c(NaN, 0, NaN, 0, 0), #'                          type = c(\"c\", \"zi\", \"c\", \"zi\", \"c\")) #'                    #' climate_2010 = lapply(climate, function(data) data[year(time) == 2010, ]) #'  #' mp_vbc = vbc(climate_2010$mp[, -\"time\"], climate_2010$mp[, -\"time\"], #'              climate_2010$rp[, -\"time\"], margins_controls = margins_controls, #'              family_set = \"tll\", trunc_lvl = Inf)                  #'  #' plot_tails(climate_2010$mp, \"pr\", scale_d = 0.1, mult = 4, xmin = 0)  #' plot_tails(climate_2010$rp, \"pr\", scale_d = 1, mult = 4, xmin = 0) #' plot_tails(round(mp_vbc, 3), \"pr\", scale_d = 1, mult = 3, xmin = 0) #' calc_wasserstein(climate_2010$mp[, \"pr\"], climate_2010$rp[, \"pr\"]) #' calc_wasserstein(climate_2010$rp[, \"pr\"], mp_vbc[, \"pr\"]) #'  #' calc_wasserstein(climate_2010$rp[, -\"time\"], climate_2010$mp[, -\"time\"]) #' calc_wasserstein(climate_2010$rp[, -\"time\"], mp_vbc) #'  #' # An example with temporal subsetting using the method of fragments #'   #' temp_subs <- list(DJF = list(hours = seq(0, 21, 3), month = c(12, 1, 2)), #'                   MAM = list(hours = seq(0, 21, 3), month = 3:5), #'                   JJA = list(hours = seq(0, 21, 3), month = 6:8), #'                   SON = list(hours = seq(0, 21, 3), month = 9:11))   #'                                   #' mp_vbc = vbc_tsub(climate$mp, climate$mc, climate$rc, t_subs = temp_subs, #'                   margins_controls = margins_controls, family_set = \"tll\", #'                   trunc_lvl = Inf) #' class(mp_vbc) #' attr(mp_vbc, \"mvd\") #'  #' measure = lapply(temp_subs, function(sub) { #'    idx = which(hour(mp_vbc$time) %in% sub$hour & #'                   month(mp_vbc$time) %in% sub$month) #'    idxrp = which(hour(climate$rp$time) %in% sub$hour & #'                      month(climate$rp$time) %in% sub$month) #'    mci = calc_mci(climate$mp[idx, -\"time\"], mp_vbc[idx, -\"time\"], #'                     time = climate$mp$time[idx]) #'    mci = attr(mci, \"global_mci\") #'     #'    uncorrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                     climate$mp[idx, -\"time\"]) #'    corrected = calc_wasserstein(climate$rp[idxrp, -\"time\"], #'                                 mp_vbc[idx, -\"time\"]) #'    data.table( #'        ModelCorrectionInconsistancy = mci, #'        Wasserstein2_uncorrected = uncorrected[2], #'        Wasserstein2_corrected = corrected[2], #'        Improvement_Wasserstein2 = uncorrected[2] - corrected[2],  #'        month = paste(sub$month, collapse = \"-\") #'        ) #' }) #' rbindlist(measure) #' }"},{"path":"https://henrifnk.github.io/VBC/news/index.html","id":"vbc-100","dir":"Changelog","previous_headings":"","what":"VBC 1.0.0","title":"VBC 1.0.0","text":"Initial CRAN submission.","code":""}]
