<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>VBC in the Alps: Multivariate Bias Correction and Evaluation • VBC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="VBC in the Alps: Multivariate Bias Correction and Evaluation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VBC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vbc_alps.html">VBC in the Alps: Multivariate Bias Correction and Evaluation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="vbc_alps_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="vbc_alps_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="vbc_alps_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="vbc_alps_files/leaflet-1.3.1/leaflet.js"></script><link href="vbc_alps_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="vbc_alps_files/proj4-2.6.2/proj4.min.js"></script><script src="vbc_alps_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="vbc_alps_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="vbc_alps_files/leaflet-binding-2.2.2/leaflet.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>VBC in the Alps: Multivariate Bias Correction and Evaluation</h1>
            
            <h4 data-toc-skip class="date">2024-10-25</h4>
      

      <div class="d-none name"><code>vbc_alps.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://henrifnk.github.io/VBC/">VBC</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">theme</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>              panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="allgäuer-hochalpen">Allgäuer Hochalpen<a class="anchor" aria-label="anchor" href="#allg%C3%A4uer-hochalpen"></a>
</h3>
<p>The Allgäuer Hochalpen are a mountainous nature reserve in the
northern Alps at the border to Austria. With up to 2,600 meters above
sea level, the nature reserve is the first northern mountain range in
the Alps. Due to this regional exposition, the Allgäuer Hochalpen are
known for their high precipitation rates and cold temperatures. The
complex topography of the region leads to a high regional climatic
variability which is challenging for climate models to simulate.</p>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[47.4,10.4,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Allgäuer Hochalpen",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]}],"setView":[[47.4,10.4],10,[]],"limits":{"lat":[47.4,47.4],"lng":[10.4,10.4]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>This exemplary showcases the potentials of the VBC package to correct
for the bias in the climate model data of the Allgäuer Hochalpen during
2011 to 2020 for 5 key climate variables. The error prone data consists
of the 50 member of the regional climate model large ensemble, CRCM5-LE
in a 12km resolution. <code>mp_dts</code> contains the model data during
projection (2011 - 2020), <code>mc_dts</code> the model data during the
calibration period (1981 - 2010). The CRCM-5 data are corrected using
the SDCLIREF version2 reference data in 12km resolution. The reference
data <code>oc_dt</code> is used to correct the model data.
<code>op_dt</code> contains the targeted distribution in is held out for
elevation purposes. For more information, see</p>
<ul>
<li><p>Funk, H., Ludwig, R., Kuechenhoff, H., &amp; Nagler, T. (2024).
Towards more realistic climate model outputs: A multivariate bias
correction based on zero-inflated vine copulas. arXiv preprint
&lt;arXiv:2410.15931&gt;.</p></li>
<li><p>Lehr- und Forschungseinheit für physische Geographie und komplexe
Umweltsysteme, &amp; Wood, R. R. (2024). SDCLIREFv2 (Version 2) [Data
set]. Zenodo. <a href="https://doi.org/10.5281/zenodo.13221576" class="external-link uri">https://doi.org/10.5281/zenodo.13221576</a></p></li>
<li><p>Funk, H. (2024). Bias Correction of CRCM5-LE for Hydrological
Bavaria (1.0.0) [Data set]. Zenodo. <a href="https://doi.org/10.5281/zenodo.13348397" class="external-link uri">https://doi.org/10.5281/zenodo.13348397</a></p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".rda"</span><span class="op">)</span></span>
<span><span class="va">url</span> <span class="op">=</span> <span class="st">"https://zenodo.org/records/13348397/files/PEG-Iller-Kempten_14_12.rda?download=1"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">temp_file</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">temp_file</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">temp_file</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="bias-correction">Bias Correction<a class="anchor" aria-label="anchor" href="#bias-correction"></a>
</h3>
<p>The bias correction is performed using the VBC package. For
demonstration purposes, the bias correction is performed for the winter
nights in the Allgäuer Hochalpen. The winter nights are defined as the
hours between 21:00 and 06:00 in the months December, January, and
February.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">winter_night</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  nightDJF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>, month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We showcase the bias correction on the first 5 members of the
CRCM5-LE. Therefore we subset the model data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">members</span> <span class="op">&lt;-</span> <span class="va">mp_dts</span><span class="op">$</span><span class="va">member</span></span>
<span><span class="va">mem_5</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kba"</span>, <span class="st">"kbb"</span>, <span class="st">"kbc"</span>, <span class="st">"kbd"</span>, <span class="st">"kbe"</span><span class="op">)</span></span>
<span><span class="va">members</span> <span class="op">=</span> <span class="va">members</span><span class="op">[</span><span class="va">members</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mem_5</span><span class="op">]</span></span>
<span><span class="va">mp_dts</span> <span class="op">=</span> <span class="va">mp_dts</span><span class="op">[</span><span class="va">member</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mem_5</span>, <span class="op">]</span><span class="op">[</span>, <span class="va">member</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">mc_dts</span> <span class="op">=</span> <span class="va">mc_dts</span><span class="op">[</span><span class="va">member</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mem_5</span>, <span class="op">]</span><span class="op">[</span>, <span class="va">member</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">split_mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">mp_dts</span>, <span class="va">members</span><span class="op">)</span></span></code></pre></div>
<p>To correct for the winter nights in the first 5 members of the
CRCM5-LE, we use the <code>vbc_tsub</code> function. The function
corrects the model data using the reference data <code>oc_dt</code>. For
the marginal distributions, we specify that the lower bound by
<code>xmin</code> and the type of the marginal distribution by
<code>type</code>. The type <code>c</code> indicates a continuous
distribution, while <code>zi</code> indicates a zero-inflated
distribution. The bias correction is performed using the
<code>TLL</code> family of vine copulas. The truncation level is set to
infinity.</p>
<p>The function now efficiently corrects the model data for each
temporal subset in <code>t_subs</code> and each member in
<code>split_mp</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">margins_controls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NaN</span>, <span class="fl">0</span>, <span class="cn">NaN</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"zi"</span>, <span class="st">"c"</span>, <span class="st">"zi"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vbc</span> <span class="op">=</span> <span class="fu"><a href="../reference/vbc_tsub.html">vbc_tsub</a></span><span class="op">(</span>mp <span class="op">=</span> <span class="va">split_mp</span>, mc <span class="op">=</span> <span class="va">mc_dts</span>, rc <span class="op">=</span> <span class="va">oc_dt</span>, t_subs <span class="op">=</span> <span class="va">winter_night</span>,</span>
<span>               margins_controls <span class="op">=</span> <span class="va">margins_controls</span>, family_set <span class="op">=</span> <span class="st">"tll"</span>,</span>
<span>               trunc_lvl <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; An ensemble member is done.</span></span>
<span><span class="co">#&gt; An ensemble member is done.</span></span>
<span><span class="co">#&gt; An ensemble member is done.</span></span>
<span><span class="co">#&gt; An ensemble member is done.</span></span>
<span><span class="co">#&gt; An ensemble member is done.</span></span></code></pre>
<pre><code><span><span class="co">#&gt; subset for 21036 hours and 1212 month done.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="evaluation">Evaluation<a class="anchor" aria-label="anchor" href="#evaluation"></a>
</h3>
<div class="section level4">
<h4 id="distributional-similarity">Distributional Similarity<a class="anchor" aria-label="anchor" href="#distributional-similarity"></a>
</h4>
<p>The bias correction is evaluated by comparing the corrected model
data with the reference data <code>op_dt</code>. Using
<code>plot_tails</code>, VBC provides a visual tool to compare the
marginal distribution of a climate variable before and after the bias
correction with the target reference data. Ideally, the corrected model
data should be as close as possible to the reference data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="va">mp_dts</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span>, <span class="st">"dew"</span>, scale_d <span class="op">=</span> <span class="fl">5</span>,</span>
<span>           offset <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span> <span class="va">theme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Pre-Correction"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">vbc</span><span class="op">)</span>, <span class="st">"dew"</span>, scale_d <span class="op">=</span> <span class="fl">5</span>, offset <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">theme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Post-Correction"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="va">op_dt</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                     <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span>, <span class="st">"dew"</span>, scale_d <span class="op">=</span> <span class="fl">5</span>,</span>
<span>             offset <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dewpoint Temperature in °C"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Reference"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="vbc_alps_files/figure-html/plot_rsds-1.png" width="672" style="display: block; margin: auto;"></p>
<p>To quantify the improvement of the bias correction, we calculate the
Wasserstein distance between the corrected model data and the reference.
The Wasserstein distance is a measure of the distance between two
probability distributions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_post</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vbc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mem</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">op_dt</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                           <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">mem</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>,</span>
<span>                   , scale_dta <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">wd_pre</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">split_mp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mem</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">op_dt</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                           <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">]</span>,</span>
<span>                   <span class="va">mem</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                         <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">]</span>,</span>
<span>                   scale_dta <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">improvement</span> <span class="op">=</span> <span class="va">wd_pre</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">wd_post</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"WD2 pre correction"</span> <span class="op">=</span> <span class="va">wd_pre</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>,</span>
<span>            <span class="st">"WD2 post correction"</span> <span class="op">=</span> <span class="va">wd_post</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,</span>
<span>            <span class="st">"imporvement after correction"</span> <span class="op">=</span> <span class="va">improvement</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="26%">
<col width="27%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">WD2 pre correction</th>
<th align="right">WD2 post correction</th>
<th align="right">imporvement after correction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">kba</td>
<td align="right">2.16</td>
<td align="right">1.91</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">kbb</td>
<td align="right">1.43</td>
<td align="right">1.25</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="left">kbc</td>
<td align="right">1.41</td>
<td align="right">1.22</td>
<td align="right">0.19</td>
</tr>
<tr class="even">
<td align="left">kbd</td>
<td align="right">1.91</td>
<td align="right">1.84</td>
<td align="right">0.07</td>
</tr>
<tr class="odd">
<td align="left">kbe</td>
<td align="right">2.07</td>
<td align="right">1.97</td>
<td align="right">0.10</td>
</tr>
</tbody>
</table>
<p>At the univariate level of dew point temperature, the bias correction
improves the model data for any of the 5 members of the CRCM5-LE.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_post</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vbc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mem</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">op_dt</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                           <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="va">mem</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wd_pre</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">split_mp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">mem</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">op_dt</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                           <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>                   <span class="va">mem</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                         <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">improvement</span> <span class="op">=</span> <span class="va">wd_pre</span> <span class="op">-</span> <span class="va">wd_post</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">"WD2 pre correction"</span> <span class="op">=</span> <span class="va">wd_pre</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>,</span>
<span>            <span class="st">"WD2 post correction"</span> <span class="op">=</span> <span class="va">wd_post</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,</span>
<span>            <span class="st">"imporvement after correction"</span> <span class="op">=</span> <span class="va">improvement</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="26%">
<col width="27%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">WD2 pre correction</th>
<th align="right">WD2 post correction</th>
<th align="right">imporvement after correction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">kba</td>
<td align="right">6.09</td>
<td align="right">1.12</td>
<td align="right">4.97</td>
</tr>
<tr class="even">
<td align="left">kbb</td>
<td align="right">6.38</td>
<td align="right">1.15</td>
<td align="right">5.23</td>
</tr>
<tr class="odd">
<td align="left">kbc</td>
<td align="right">6.48</td>
<td align="right">1.30</td>
<td align="right">5.19</td>
</tr>
<tr class="even">
<td align="left">kbd</td>
<td align="right">6.20</td>
<td align="right">1.02</td>
<td align="right">5.18</td>
</tr>
<tr class="odd">
<td align="left">kbe</td>
<td align="right">6.13</td>
<td align="right">1.06</td>
<td align="right">5.08</td>
</tr>
</tbody>
</table>
<p>On the global multivariate distribution, the bias correction improves
the model data for any of the 5 members to a 6th of its 2nd Wasserstein
Distance to a constant level of 1.</p>
</div>
<div class="section level4">
<h4 id="preservation-of-weather">Preservation of Weather<a class="anchor" aria-label="anchor" href="#preservation-of-weather"></a>
</h4>
<p>When correcting the model data, it is important that the bias
correction method preserves the course of weather patterns of the model
data. This way the original characteristics of the climate model are
still maintained. The MCI is a measure of the preservation of the
weather patterns.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mci</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">before</span>, <span class="va">after</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">hour</a></span><span class="op">(</span><span class="va">before</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">month</a></span><span class="op">(</span><span class="va">before</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/calc_mci.html">calc_mci</a></span><span class="op">(</span><span class="va">before</span><span class="op">[</span><span class="va">idx</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,<span class="va">after</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>           time_p <span class="op">=</span> <span class="va">before</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">mci</span></span>
<span><span class="op">}</span>, before <span class="op">=</span> <span class="va">split_mp</span>, after <span class="op">=</span> <span class="va">vbc</span><span class="op">)</span></span>
<span><span class="va">mci</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">mci</span>, time <span class="op">=</span> <span class="va">vbc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">mci</span><span class="op">$</span><span class="va">median</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mci</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">median</span><span class="op">)</span></span></code></pre></div>
<p>The MCI of the first 5 members of the CRCM5-LE during winter nights
2019 is mostly between 0 and 0.1. A MCI of 0 indicates an non-invasive
bias correction that did not change the course of the weather patterns
from the model data. The MCI is limited at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>
indicating a maximal change in the course of weather.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mci2020</span> <span class="op">=</span> <span class="va">mci</span><span class="op">[</span><span class="va">mci</span><span class="op">$</span><span class="va">time</span> <span class="op">&gt;</span> <span class="st">"2019-11-01"</span> <span class="op">&amp;</span> <span class="va">mci</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;</span> <span class="st">"2020-03-01"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mci2020</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">kba</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightblue"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">kbb</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightblue"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">kbc</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightblue"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">kbd</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightblue"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">kbe</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"lightblue"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">median</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"navyblue"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, colour <span class="op">=</span> <span class="st">"lightgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="va">theme</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    caption <span class="op">=</span> <span class="st">"MCI of the first 5 members of the CRCM5-LE (lightblue) and their median (navyblue) during winter nights 2019"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"MCI"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vbc_alps_files/figure-html/plot_mci2020-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The average MCI of a corrected time series can be used for the global
assessment of the correction. With an median inconsistency of 0.03, we
can assume the weather in winter nights 2019/2020 to be mainly
preserved.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mci</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">median</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mci</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">median</th>
<th align="right">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">kba</td>
<td align="right">0.036</td>
<td align="right">0.058</td>
</tr>
<tr class="even">
<td align="left">kbb</td>
<td align="right">0.030</td>
<td align="right">0.057</td>
</tr>
<tr class="odd">
<td align="left">kbc</td>
<td align="right">0.028</td>
<td align="right">0.064</td>
</tr>
<tr class="even">
<td align="left">kbd</td>
<td align="right">0.016</td>
<td align="right">0.046</td>
</tr>
<tr class="odd">
<td align="left">kbe</td>
<td align="right">0.025</td>
<td align="right">0.054</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henri Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
