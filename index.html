<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vine Copula based Bias Correction for Climate Models • VBC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Vine Copula based Bias Correction for Climate Models">
<meta name="description" content="VBC implements a method to correct the bias in simulated climate data with observed data while preserving the internal variability of the model. To evaluate the method and compare it with others, several post hoc diagnostic measures are provided. The MCI is a measure to evaluate how well the correction method preserved the rank structure of model data. Wasserstein metrics can be calculated to determine, how distant the distributions of corrected and measured data are.">
<meta property="og:description" content="VBC implements a method to correct the bias in simulated climate data with observed data while preserving the internal variability of the model. To evaluate the method and compare it with others, several post hoc diagnostic measures are provided. The MCI is a measure to evaluate how well the correction method preserved the rank structure of model data. Wasserstein metrics can be calculated to determine, how distant the distributions of corrected and measured data are.">
<meta property="og:image" content="https://henrifnk.github.io/VBC/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">VBC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/vbc_alps.html">VBC in the Alps: Multivariate Bias Correction and Evaluation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="bias-correction-by-zero-inflated-vine-copulas-">Bias Correction by Zero-Inflated Vine Copulas <a class="anchor" aria-label="anchor" href="#bias-correction-by-zero-inflated-vine-copulas-"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<p>Vine Copula Bias Correction for partially zero-inflated margins (VBC) is a multivariate bias correction methodology anchored in vine copula theory. For this method, we generalized the margins, the copula and the vine copula density to accommodate mixture distributions and propose an extension to the Rosenblatt transform that can handle non-continuous pseudo observations. The proposed method is tailored to model dependencies between heavy tailed, zero-inflated and continuous climate variables with high temporal resolution, ensuring precise corrections. Notably, our approach is designed for high interpretability, enabling control and assessment of the results.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development versions for zero inflation from <code>kde1d</code> and <code>rvinecopulib</code> before installing the development version of VBC from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prerequisits</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vinecopulib/rvinecopulib@pull-zi"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tnagler/kde1d@dev"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># without vignette</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"henrifnk/VBC"</span><span class="op">)</span></span>
<span><span class="co"># with vignette</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"henrifnk/VBC"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>We aim to correct CRCM5 climate data for Munich, Germany, for the year 2010. The data is available in the package as <code>climate</code>. We will use the <code>vbc</code> function to correct the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://henrifnk.github.io/VBC/">VBC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"climate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">climate_2010</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">climate</span>, <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/IDateTime.html" class="external-link">year</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2010</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Climate data are available in 3-hourly resolution for the variables temperature, precipitation, dew point temperature, radiation and wind speed. The high temporal resolution causes inflation in the variables radiation and precipitation. Visually, check the shape of the marginal distributions of the model data and the reference data using <code>plot_tails</code>. The distance between the two marginal distributions can be quantified using the Wasserstein distance.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">mp</span>, <span class="st">"pr"</span>, scale_d <span class="op">=</span> <span class="fl">0.1</span>, mult <span class="op">=</span> <span class="fl">4</span>, xmin <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">"Marginal distribution of uncorrected model data"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">rp</span>, <span class="st">"pr"</span>, scale_d <span class="op">=</span> <span class="fl">1</span>, mult <span class="op">=</span> <span class="fl">4</span>, xmin <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"precipitation (mm/h)"</span>,  </span>
<span>       title <span class="op">=</span> <span class="st">"Marginal targeted distribution of reference data"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span></code></pre></div>
<p><img src="reference/figures/README-zeroinflation-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">wd_pre</span> <span class="op">=</span> <span class="fu"><a href="reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">mp</span><span class="op">[</span>, <span class="st">"pr"</span><span class="op">]</span>, <span class="va">climate_2010</span><span class="op">$</span><span class="va">rp</span><span class="op">[</span>, <span class="st">"pr"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">wd_pre</span></span>
<span><span class="co">#&gt; Wasserstein_1 Wasserstein_2 </span></span>
<span><span class="co">#&gt;    0.05947432    0.21964470</span></span></code></pre></div>
<p>For the correction, we need to specify the type of margins and their limits. <code>"zi"</code> defines a univariate margins and <code>"c"</code> a strictly continuous margin. <code>xmin</code> specifies the lower bound of the margins. For the vine copula modeling, we use the <em>TLL</em> family set with no truncation on the vine.</p>
<p>We can then visually and quantitatively asses the correction in <code>mp_vbc</code> by comparing the corrected data and the reference data by plotting the tails and calculating the Wasserstein distances. The results can be compared to those above.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_tails.html">plot_tails</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mp_vbc</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"pr"</span>, scale_d <span class="op">=</span> <span class="fl">1</span>, mult <span class="op">=</span> <span class="fl">3</span>, xmin <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"precipitation (mm/h)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Marginal distribution of corrected model data"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-zi-correction-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Visibly, the correction shortens the heavy tail and increases the density inflation at zero. This is also reflected in the Wasserstein distance.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_post</span> <span class="op">=</span> <span class="fu"><a href="reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">rp</span><span class="op">[</span>, <span class="st">"pr"</span><span class="op">]</span>, <span class="va">mp_vbc</span><span class="op">[</span>, <span class="st">"pr"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Wasserstein_Uncorrected"</span> <span class="op">=</span> <span class="va">wd_pre</span>,</span>
<span>                 <span class="st">"Wasserstein_Corrected"</span> <span class="op">=</span> <span class="va">wd_post</span>,</span>
<span>                 <span class="st">"Improvement"</span> <span class="op">=</span> <span class="va">wd_pre</span> <span class="op">-</span> <span class="va">wd_post</span>,</span>
<span>                 <span class="st">"Improvement_in_Perc"</span> <span class="op">=</span> <span class="op">(</span><span class="va">wd_pre</span> <span class="op">-</span> <span class="va">wd_post</span><span class="op">)</span> <span class="op">/</span> <span class="va">wd_pre</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Wasserstein_Uncorrected</th>
<th align="right">Wasserstein_Corrected</th>
<th align="right">Improvement</th>
<th align="right">Improvement_in_Perc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Wasserstein_1</td>
<td align="right">0.06</td>
<td align="right">0.02</td>
<td align="right">0.04</td>
<td align="right">61.41</td>
</tr>
<tr class="even">
<td align="left">Wasserstein_2</td>
<td align="right">0.22</td>
<td align="right">0.08</td>
<td align="right">0.14</td>
<td align="right">63.71</td>
</tr>
</tbody>
</table>
<p>Further we can quantify the multivariate improvement of our correction in terms of the Wasserstein distances.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wd_mvd_post</span> <span class="op">=</span> <span class="fu"><a href="reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">rp</span><span class="op">[</span>, <span class="op">-</span><span class="st">"time"</span><span class="op">]</span>, <span class="va">mp_vbc</span><span class="op">)</span></span>
<span><span class="va">wd_mvd_pre</span> <span class="op">=</span> <span class="fu"><a href="reference/calc_wasserstein.html">calc_wasserstein</a></span><span class="op">(</span><span class="va">climate_2010</span><span class="op">$</span><span class="va">rp</span><span class="op">[</span>, <span class="op">-</span><span class="st">"time"</span><span class="op">]</span>,</span>
<span>                              <span class="va">climate_2010</span><span class="op">$</span><span class="va">mp</span><span class="op">[</span>, <span class="op">-</span><span class="st">"time"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">iprovement</span> <span class="op">=</span> <span class="va">wd_mvd_pre</span> <span class="op">-</span> <span class="va">wd_mvd_post</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Wasserstein_Uncorrected"</span> <span class="op">=</span> <span class="va">wd_mvd_pre</span>,</span>
<span>                 <span class="st">"Wasserstein_Corrected"</span> <span class="op">=</span> <span class="va">wd_mvd_post</span>,</span>
<span>                 <span class="st">"Improvement"</span> <span class="op">=</span> <span class="va">iprovement</span>,</span>
<span>                 <span class="st">"Improvement_in_Perc"</span> <span class="op">=</span> <span class="va">iprovement</span> <span class="op">/</span> <span class="va">wd_mvd_pre</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>      digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Wasserstein_Uncorrected</th>
<th align="right">Wasserstein_Corrected</th>
<th align="right">Improvement</th>
<th align="right">Improvement_in_Perc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Wasserstein_1</td>
<td align="right">0.66</td>
<td align="right">0.37</td>
<td align="right">0.28</td>
<td align="right">43.21</td>
</tr>
<tr class="even">
<td align="left">Wasserstein_2</td>
<td align="right">0.95</td>
<td align="right">0.48</td>
<td align="right">0.47</td>
<td align="right">49.66</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level1">
<h1 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h1>
<p>If you use <code>VBC</code> in a scientific publication, please <a href="https://arxiv.org/abs/2410.15931" class="external-link">cite</a> it as:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>Funk, H., Ludwig, R., Kuechenhoff, H., <span class="sc">&amp;</span> Nagler, <span class="fu">T.</span> (<span class="dv">2024</span>). Towards more realistic climate model outputs<span class="sc">:</span> A multivariate bias correction based on zero<span class="sc">-</span>inflated vine copulas. arXiv preprint arXiv<span class="sc">:</span><span class="dv">2410</span>.<span class="fl">15931.</span></span></code></pre></div>
<p>BibTeX:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode tex"><code class="sourceCode latex"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>@article{funk2024,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  title={Towards more realistic climate model outputs: A multivariate bias correction based on zero-inflated vine copulas},</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  author={Funk, Henri and Ludwig, Ralf and Kuechenhoff, Helmut and Nagler, Thomas},</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  journal={arXiv preprint arXiv:2410.15931},</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  year={2024}</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>}</span></code></pre></div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/LGPL-3" class="external-link">LGPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing VBC</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Henri Funk <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0007-0949-8385" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henri Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
